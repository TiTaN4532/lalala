{% extends "LaNetAdminBundle::layout.html.twig" %}
  
{% block content %}
   
     <div>
        <form action="">
            <input placeholder="Поиск обучения" style="margin-bottom:0;width:80%;" type="text" name="name" {% if app.request.query.get('name') %}value="{{ app.request.query.get('name') }}"{% endif %}>
            
            <input style="margin-left:10px;" type="submit" value="Найти">
        </form>
    </div>
    <h1>Обучение</h1>
    <div class="results">
        {% for flashMessage in app.session.flashbag.get('notice_school') %}
          <div class="flash-notice success">
              {{ flashMessage }}
          </div>
        {% endfor %}
    </div>
    {#<div id="users-nav">
        <span><a href="" class="users-filter active-link" data="">#</a></span>
        <span><a href="" class="users-filter" data="">0-9</a></span>
        {% for letter in 'а'..'я' %}
            <span><a href="" class="users-filter" data="{{letter}}">{{letter|upper}}</a></span>
        {% endfor %}
    </div>#}
      
   <div style="margin-top: 30px;" id="users-list">
        {% for school in schools %}
            <div class="user-item">

                      {#<div class="image col col_1_of_6 tablet_1_of_3 mobile_1_of_1"><img src="{{ asset(master.getWebPath) | imagine_filter('my_master_thumb_medium') }}"></div>#}
              <div class="col col_2_of_6 tablet_1_of_3 mobile_1_of_1">
                    Email: <br />
                    <span>{{ school.user.email }}</span>
                </div>  

                <div class="col col_2_of_6 tablet_1_of_3 mobile_1_of_1">
                     Название: <br />
            <span>{{ school.name }}</span>
        </div>
        
        <div class="col col_1_of_6 tablet_1_of_3 mobile_1_of_1">
                    Дата регистрации: <br />
           <span>{{ school.user.created|date("m/d/Y") }}</span>
        </div>
        
                <div class="col col_1_of_6 tablet_1_of_3 mobile_1_of_1">
                    <a href="javascript:void(0)" class="remove-school button" data="{{ school.user.id }}">Удалить</a>
                     <a href="{{ path('la_net_admin_ajax_inTop_school', {'id': school.id} ) }}" class="update-post button">{% if school.inTop == NULL %}Вывести в ТОП{% else %}Удалить из ТОП{% endif %}</a>
                    <a href="{{ path('la_net_admin_ajax_premium_school', {'id': school.id} ) }}" class="premium button">{% if school.getUser.premium == NULL %}Добавить премиум{% else %}Удалить премиум{% endif %}</a>
                    {% if salon.user.validation == '1' %} <h5 style='color: #6cb55d;'>Валидирован</h5>{% else %}<h5 style='color: red;'>Не валидир.</h5>{% endif %}
                     {#<a href="{{ path('la_net_admin_masters_edit_profile', {'id': master.id} ) }}" class="button">Редактировать</a>#}
                </div>
            </div>
           <div class="clear"></div>
                    <hr>
        {% endfor %}
               
        {{ knp_pagination_render(schools) }}
    </div>
    <script>
    $(document).ready(function() {

        $('a.remove-school').click(function(event) {
            event.preventDefault();
            if(confirm("Уверены что хотите удалить?")) {
                var link = $(this);
                $.ajax({
                  url: Routing.generate('la_net_admin_ajax_delete_school', {'id':link.attr('data')}),
                  success     : function(data) {
                          link.parents('.user-item').remove();
                       }
                  });
            }
          });

        $('.update-post').click(function(event) {
            event.preventDefault();
            var element = $(this);
            $.ajax({
                url         : element.attr('href'),
                success     : function(data) {

                    if (element.text() == "Вывести в ТОП"){
                            element.text('Удалить из ТОП')

                    } else {
                            element.text('Вывести в ТОП')
                    }
                }
            });
          });
          
            $('.premium').click(function(event) {
            event.preventDefault();
            var element = $(this);
            $.ajax({
                url         : element.attr('href'),
                success     : function(data) {
                    
                    if (element.text() == "Добавить премиум"){
                            element.text('Удалить премиум')
            
                    } else {
                            element.text('Добавить премиум')
                    }
                }
            });
          });

    });
    </script>
   {% endblock content %}

