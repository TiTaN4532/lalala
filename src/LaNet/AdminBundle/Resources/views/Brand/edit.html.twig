{% extends "LaNetAdminBundle::layout.html.twig" %}
 
{% block stylesheets %}
      {{ parent() }}
      <script src="{{ asset('bundles/lanetlanet/js/previewImage.js') }}"></script>
      <script src="{{ asset('bundles/lanetadmin/js/brand_category_collection.js') }}"></script>
  {% endblock %}
      
  {% macro category_prototype(mail) %}
   {{ form_widget(mail.name) }}
{% endmacro %}

{% form_theme form 'LaNetLaNetBundle:Form:fields.html.twig' %}

  
{% block content %}
  <h2>{% if brand.getId %}Обновить "{{ brand.name }}"{% else %}Создать {% endif %} бренд</h2>
  <form action="" method="post" {{ form_enctype(form) }}>
        {{ form_widget(form.file) }}
    {{ form_row(form.name) }}
    {{ form_row(form.country) }}
    {{ form_row(form.masterCategory) }}
     <label>Линейки:</label>
    <ul style="padding:0px;" class="category" data-prototype="{{ _self.category_prototype(form.category.vars.prototype)|e }}">
        {% for item in form.category %}
            <li>{{ form_widget(item.name) }}</li>
        {% endfor %}
    </ul>
    {{ form_row(form.link) }}
    {{ form_row(form.description) }}
    <div>
      <button id="cancel-brand-btn">Назад</button>
    {{ form_widget(form.save) }}
    </div>
    {{ form_rest(form) }}
  </form>
  <script>
      $(document).ready(function(){
          $('#cancel-brand-btn').click(function() {
               window.location = Routing.generate('la_net_admin_brand_list');
            });
        {% if brand.id %}
        $('.remove-image').click(function(event) {
        event.preventDefault();
          var el = $(this);
          $.ajax({
              url         : Routing.generate('la_net_admin_brand_remove_image', {'id': {{ brand.id }}}),
              success     : function(data) {
                if(data) { 
                  el.prev('img').remove();
                  el.remove(); } }
          })
      })
      {% endif %}
        });
  </script>
{% endblock %}